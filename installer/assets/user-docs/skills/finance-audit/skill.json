{
  "schema_version": "ah32.skill.v1",
  "meta": {
    "id": "finance-audit",
    "name": "财务审计助手",
    "version": "0.2.0",
    "enabled": true,
    "priority": 30,
    "description": "面向财务审计/对账/异常核验：输出异常清单、核验步骤、佐证材料与关键发现摘要。",
    "group": "finance"
  },
  "routing": {
    "hosts": [
      "writer"
    ],
    "tags": [
      "财务",
      "审计",
      "对账",
      "异常",
      "口径"
    ],
    "intents": [
      "finance_audit",
      "anomaly_detection",
      "reconcile"
    ],
    "triggers": [
      "财务",
      "审计",
      "对账",
      "异常",
      "波动",
      "报表",
      "预算",
      "毛利",
      "费用",
      "收入",
      "成本",
      "发票",
      "凭证",
      "流水",
      "应收",
      "应付"
    ],
    "examples": [
      "对这份财务数据做异常点清单，并给出需要的佐证与核验步骤",
      "输出对账差异原因假设，并给出下一步核验清单",
      "按收入/费用/采购/现金流四条链路给出取证与核验步骤"
    ]
  },
  "capabilities": {
    "active_doc_text": true,
    "active_doc_max_chars": 60000
  },
  "output": {
    "markers": [
      "异常/差异清单表",
      "核验步骤",
      "需要的佐证材料",
      "范围与口径",
      "关键发现摘要",
      "取证链条"
    ],
    "output_schema": "输出必须包含：1) 范围与口径；2) 关键发现摘要；3) 异常/差异清单表（现象-可能原因-佐证-核验步骤）；4) 待办；5) 自检清单。",
    "max_chars": 3400,
    "styleSpecHints": {
      "writer": {
        "font": {
          "body": {
            "name": "??",
            "size": 12
          }
        },
        "table": {
          "header": {
            "bold": true,
            "fill": "#f1f5f9"
          }
        }
      },
      "group": "finance",
      "schema": "ah32.styleSpecHints.v1"
    }
  },
  "entry": {
    "system_prompt": "SYSTEM.docx"
  },
  "tools": [
    {
      "name": "data_parser",
      "description": "解析表格/CSV/TSV/Markdown 表格为结构化预览（默认读取当前文档，无需传 doc_text）",
      "parameters": {
        "type": "object",
        "properties": {
          "doc_text": { "type": "string", "description": "表格文本（可省略，默认使用当前文档）" },
          "max_preview_rows": { "type": "integer", "description": "最多返回多少行预览" },
          "max_cols": { "type": "integer", "description": "最多解析多少列" },
          "delimiter": { "type": "string", "description": "强制分隔符（\\t 或 ,），为空则自动" }
        },
        "required": []
      }
    },
    {
      "name": "anomaly_detector",
      "description": "基于规则检测数值异常（负数/零值/离群/大额）（默认读取当前文档，无需传 doc_text）",
      "parameters": {
        "type": "object",
        "properties": {
          "doc_text": { "type": "string", "description": "表格文本（可省略，默认使用当前文档）" },
          "numeric_columns": { "type": "array", "items": { "type": "string" }, "description": "指定要检查的列名；为空则自动推断" },
          "amount_threshold": { "type": "number", "description": "大额阈值（abs(value) >= threshold）" },
          "max_results": { "type": "integer", "description": "最多返回多少条异常" }
        },
        "required": []
      }
    }
  ]
}
